@model List<Flybiletter.Models.Departure>

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet" />
    <title>Reise</title>
    <script src="~/Scripts/jquery-3.2.1.min.js"></script>
    <script type="text/javascript">

        /*
        $("tbody").on("click", "tr", function (e) {
            $(this)
                .toggleClass("selected")
                .siblings(".selected")
                .removeClass("selected");
        });*/

        function depRows() {
            $('tr.clickDep').click(function () {
                var tableData = $(this).children("td").map(function () {
                    return $(this).text();
                }).get();

                //bygger et order objekt fra brukerens selected row
                var orderInn = {
                     id : $.trim(tableData[0]),
                     time : $.trim(tableData[1]),
                     date : $.trim(tableData[2]),
                     from : $.trim(tableData[3]),
                     to : $.trim(tableData[4]),
                     price : $.trim(tableData[5])
                }
                
                $.ajax({
                    url: '/Home/FlightDetailsTest',
                    type: 'POST',
                    data: "data=" + JSON.stringify({orderInn),
                    contentType: "application/json;charset=utf-8",
                    success: function (response) {
                       // showOrderInfo(orderInn);
                        window.location.href = "/Home/Confirmation";
                    },
                    error: function (x, y, z) {
                        alert(x + '\n' + y + '\n' + z);
                    }
                });

                /*
                alert("FLYINFO \nFlightID: " + id +
                    "\nTid: " + tid +
                    "\nDato: " + dato +
                    "\nFra: " + fra +
                    "\nTil: " + til +
                    "\nPris: " + pris)
                */

                 // var id = orderInn.id;
                //window.location("Home/Passenger?ID=" + id);
            });
        }

        function showOrderInfo(order) {
            var string = "ID: " + order.id + "\nTid: " + order.date + "\nFra: " +
                order.from + "\nTo: " + order.to + "\nPrice: " + order.price;
            $("#varInfo").html(string);
        }

    </script>
</head>
<body>
    <div class="container">
        <!--UTREISE-->
        <h2 id="tickets-header">UTREISE</h2>
        <div class="biletter">
            <table class="table" id="tableDep">
                <thread>
                    <tr>
                        <th>Flight ID</th>
                        <th>Tid</th>
                        <th>Dato</th>
                        <th>Fra</th>
                        <th>Til</th>
                        <th>Pris</th>
                    </tr>
                    <tbody>
                        @{
                            int[] array = ViewData["Price"] as int[];
                            int i = -1;

                            if (array.Length == 0)
                            {
                                <tr><td><p>Det er ingen avganger denne datoen</p></td></tr>
                            }
                            else
                            {

                                foreach (var departure in Model)
                                {
                                    i++;
                                <tr onclick="depRows(this)" class="clickDep">
                                    <td id="flightID">@departure.FlightId</td>
                                    <td>@departure.DepartureTime</td>
                                    <td>@departure.Date</td>
                                    <td>@departure.From</td>
                                    <td>@departure.To</td>
                                    <td>@array[i]</td>
                                </tr>
                                    }
                                }
                            }
                    </tbody>
                </thread>
            </table>
        </div>

        <div id="showOrderInfo"></div>

        <br />
        <a href="Index" class="btn btn-lg btn-default pull-left">Tilbake</a>
        <input type="submit" value="Velg" class="btn btn-lg btn-primary pull-right" id="button-design" />

        <!--<a href="/Home/Passenger" class="btn btn-lg btn-primary pull-right" id="button-design">Fortsett</a>-->
    </div>

</body>
</html>
